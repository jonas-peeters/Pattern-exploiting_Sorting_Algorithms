# Improving Sorting Algorithm Performanceby Optimising Branch Prediction - Digital Appendix

* Main benchmark program is in `benchy.c++`
* `output-clang-c++-full.csv` and `output-gcc-c++-full.csv` contain the 
  benchmark results for all algorithms compiled using GCC and Clang

To compile `benchy.c++`, PAPI is required, which can be found [here](https://icl.utk.edu/papi/software/index.html).

With the authors current configuration, the following commands compile the program successfully:

```sh
$ clang++-12 -O3 -mtune=native -march=native -I/usr/include/x86_64-linux-gnu/c++/10/bits -lm -L/usr/local/lib -lpapi -std=c++17 benchy.c++ -o benchy
$ g++-10 -O3 -mtune=native -march=native -I/usr/include/x86_64-linux-gnu/c++/10/bits -lm -L/usr/local/lib -lpapi -std=c++17 benchy.c++ -o benchy
```

The benchmark program has to be started with admin rights. These are required for access to the CPU performance counters

The program can be supplied with up to four arguments:

1. Algorithm name: Is substring matched to the list in benchy.c++::122-137)
2. "Before sort action": Action that will be performed to the input array before sorting. 
    0. 0 = NOTHING
    1. 1 = PRESORTED
    2. 2 = SORT_REVERSE
    3. 3 = END_RANDOM
    4. 4 = LIMIT_VALUES_1000
    5. 5 = LIMIT_VALUES_10000
3. Array size to test
4. Seed for rand(), otherwise 1-5 are used

If the appication stops with an error from PAPI complaining about too many different CPU counters, try removing some 
from the list at benchy.c++::155-159, as your CPU is capable of fewer than are in there.

The application will output the average number of CPU cycles for the biggest array tested for each algorithm-test-combo.
The full results are written to the files `output-clang-c++.csv` and `output-gcc-c++.csv` depending on the compiler
used.
